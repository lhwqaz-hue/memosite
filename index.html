<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>krople memo : 로그인 없는 메모장</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body data-theme="light">
    <!-- 메모장 화면 (항상 표시) -->
    <div class="header">
        <div class="header-left">
            <h1 class="logo">krople Memo</h1>
            <!-- 단어 일괄 수정 -->
            <div class="replace-bar-inline">
                <div class="find-input-wrapper">
                    <input 
                        type="text" 
                        id="find-input" 
                        placeholder="찾을 단어..."
                        autocomplete="off"
                    >
                    <span id="find-count" class="find-count"></span>
                </div>
                <span class="replace-arrow">→</span>
                <div class="replace-input-wrapper">
                    <input 
                        type="text" 
                        id="replace-input" 
                        placeholder="바꿀 단어..."
                        autocomplete="off"
                    >
                </div>
                <button id="replace-btn" class="replace-btn" title="모두 바꾸기">바꾸기</button>
                <button id="undo-btn" class="undo-btn" title="실행취소 (Ctrl+Z)">↶</button>
            </div>
        </div>
        <div class="header-right">
            <div class="password-info">
                <button id="key-button" class="key-button" title="클릭하여 키 설정/변경">KEY</button>
            </div>
            <div class="timer-info" id="timer-info">
                <button id="timer-button" class="timer-button" title="클릭하여 유효시간 설정" disabled>
                    <span id="timer-display">⏱️ --:--</span>
                </button>
            </div>
            <button id="theme-toggle" class="theme-toggle" title="테마 전환">D</button>
        </div>
    </div>
    
    <div class="memo-container">
        <textarea 
            id="memo-editor" 
            placeholder="여기에 메모를 작성하세요..."
            spellcheck="false"
        ></textarea>
    </div>
    
    <div class="status-bar">
        <span id="save-status"></span>
        <div class="char-count-group">
            <span id="char-count">0자</span>
            <span class="char-count-divider">|</span>
            <span id="char-count-no-space">0자(공백제외)</span>
        </div>
    </div>

    <!-- 키 입력 팝업 모달 -->
    <div id="key-modal" class="modal active">
        <div class="modal-content" style="user-select: none;">
            <button id="close-modal-btn" class="close-modal-btn" title="닫기">✕</button>
            <h1 class="modal-logo">krople Memo</h1>
            <p class="subtitle">키로 메모를 공유하세요</p>
            
            <!-- 키 설정 영역 -->
            <div class="key-section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <h2 style="margin: 0;">🔑 새 키 설정</h2>
                    <label class="hide-password-toggle" title="글자 가리기">
                        <span class="hide-label">숨기기</span>
                        <input type="checkbox" id="hide-password-checkbox">
                        <span class="checkbox-custom"></span>
                    </label>
                </div>
                <div class="key-input-group">
                    <input 
                        type="text" 
                        id="set-key-input" 
                        placeholder="4자 이상"
                        autocomplete="off"
                        style="user-select: text;"
                    >
                    <button id="set-key-btn">설정</button>
                </div>
                <p id="set-key-error" class="error-message"></p>
            </div>

            <div class="divider">또는</div>
            
            <!-- 키 불러오기 영역 -->
            <div class="key-section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <h2 style="margin: 0;">📥 키 불러오기</h2>
                    <label class="hide-password-toggle" title="글자 가리기">
                        <span class="hide-label">숨기기</span>
                        <input type="checkbox" id="hide-load-password-checkbox">
                        <span class="checkbox-custom"></span>
                    </label>
                </div>
                <div class="key-input-group">
                    <input 
                        type="text" 
                        id="load-key-input" 
                        placeholder="키 입력"
                        autocomplete="off"
                        style="user-select: text;"
                    >
                    <button id="load-key-btn">불러오기</button>
                </div>
                <p id="load-key-error" class="error-message"></p>
            </div>
        </div>
    </div>

    <!-- 유효시간 설정 모달 -->
    <div id="duration-modal" class="modal">
        <div class="modal-content modal-small">
            <button id="close-duration-modal-btn" class="close-modal-btn" title="닫기">✕</button>
            <h2>⏱️ 유효시간 설정</h2>
            <p class="subtitle">메모의 유효시간을 변경하세요</p>
            <div class="duration-options">
                <button class="duration-option" data-minutes="5">5분</button>
                <button class="duration-option" data-minutes="10">10분</button>
                <button class="duration-option" data-minutes="30">30분</button>
                <button class="duration-option" data-minutes="60">1시간</button>
                <button class="duration-option" data-minutes="180">3시간</button>
                <button class="duration-option" data-minutes="360">6시간</button>
                <button class="duration-option" data-minutes="720">12시간</button>
                <button class="duration-option" data-minutes="1440">24시간</button>
            </div>
            <button id="delete-key-btn" class="delete-key-btn">🗑️ 키 삭제</button>
        </div>
    </div>

    <script src="app-supabase.js"></script>
</body>
</html>
